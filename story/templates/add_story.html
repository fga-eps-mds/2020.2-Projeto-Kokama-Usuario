{% extends 'base_adm.html' %}

{% block title %}Adicionar História{% endblock %}

{% block content %}
<div class='content-box big'>
    {% if id %}
        <h1>Editar História</h1>
    {% else %}
        <h1>Adicionar História</h1>
    {% endif %}
    <form id="form-container" action="/historia/adicionar_historia/{{id}}" method="POST">
        {% csrf_token %}

        {% for error in story_form.language.errors %}
            <p class="red-text">{{ error }}</p>     
        {% endfor %}
        <div class="drop-down-box">
            <label class="drop-down-text" for="story_language">
                Escolha o idioma:
            </label>
            {{story_form.language}}
        </div>

        {% for error in story_form.title.errors %}
            <p style="color: red" id="erro_title">{{ error }}</p>
        {% endfor %}
        <div class='input-box'>
            {{ story_form.title }}
            <label>Título:</label>
        </div>

        {% for error in story_form.text.errors %}
        <p style="color: red" id="erro_text">>{{ error }}</p>
        {% endfor %}
        <label>Texto:</label>
        <div class='textarea-input'>
            {{ story_form.text }}
        </div>

        <button class="submit-buttom" type="submit">Salvar</button>
</div>

<script>
    let container = document.querySelector("#form-container")
    let language = document.querySelector("#id_language").value
    let titleArea = document.querySelector(".input-box")
    let textArea = document.querySelector(".textarea-input")
    let submitButton = document.querySelector(".submit-buttom")

    // Se selected for "ambos"
    if (language == 1) {
        let newTitleArea = titleArea.cloneNode(true)
        let newTitleForm = newTitleArea.children[0]

        let newTextArea = textArea.cloneNode(true)
        let newTextForm = newTextArea.children[0]

        // Zerar valores do clone
        newTitleForm.setAttribute('value', '')
        newTextForm.setAttribute('value', '')

        submitButton.style.display='none'
        let newSubmitButton = submitButton.cloneNode(true)
        newSubmitButton.style.display='block'
        

        // Remover erros do clone
        //newTitleForm.children["title_error"]?.remove()
        //newTextForm.children["text_error"]?.remove()

        // Insere novos forms no html
        container.appendChild(newTitleArea)
        container.appendChild(newTextArea)
        container.appendChild(newSubmitButton)
    }


</script>

{% endblock %}



